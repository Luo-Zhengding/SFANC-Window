# CNN-based SFANC implemented in ANC Window

This repository contains the code for the paper "**Real-time Implementation and Explainable AI Analysis of Delayless CNN-based Selective Fixed-filter Active Noise Control**," accepted by the *Mechanical Systems and Signal Processing* journal. The paper is available on [ResearchGate](https://www.researchgate.net/publication/379371184_Real-time_implementation_and_explainable_AI_analysis_of_delayless_CNN-based_selective_fixed-filter_active_noise_control) and [Elsevier](https://www.sciencedirect.com/science/article/pii/S0888327024002620).

<p align="center">
  <img src="https://github.com/Luo-Zhengding/SFANC-Window/assets/95018034/de1f3812-74ac-4461-85b2-707b56064f07" height="300">
  <img src="https://github.com/Luo-Zhengding/SFANC-Window/assets/95018034/81b6b1db-a9e4-4e2d-afe0-6ed24d708182" height="400">
  <img src="https://github.com/Luo-Zhengding/SFANC-Window/assets/95018034/b2973645-06ec-405f-835b-ac17268f3873" height="300">
</p>

## Video of Experiment Results
- [Active Noise Control Window based on SFANC](https://youtu.be/K1pWeNLMoDM)

## Highlights
1. Implements CNN-based selective fixed-filter active noise control (SFANC) in a multichannel ANC window for delayless noise reduction.
2. Abstracts ANC as a Markov process and provides a theoretical analysis to validate the CNN-based SFANC method.
3. Utilizes an explainable AI technique, LayerCAM, to visually explain the decision-making process in the CNN-based SFANC method.
4. Demonstrates effective attenuation of various low-frequency noises and good transferability through simulations and real-time experiments.

## Usage
### Pre-trained CNN
- A synthetic noise dataset is used to train the CNN, containing 80,000 noise instances for training. The noise instances are generated by filtering white noise through various bandpass filters with randomly chosen center frequencies and bandwidths. Each noise instance has a 1-second duration.
- The code and pre-trained model of the CNN are provided in `Modified_ShufflenetV2.py` and `ShuffleNetV2_Synthetic.pth`, respectively.

### Real-time Implementation
- 7 pre-trained control filters are obtained in the 4-channel ANC window with 1 reference microphone, 4 secondary sources, and 4 error sensors. 7 broadband noises with different frequency ranges (as shown in the figure below) are used as primary noises to obtain the corresponding pre-trained control filters.
<p align="center">
  <img src="https://github.com/Luo-Zhengding/SFANC-Window/assets/95018034/82d0625b-3335-408e-abd1-492fcf88583e" height="100">
</p>
- During real-time noise control, the laptop runs the code `Main_SFANC_Window.ipynb` to transmit the index of the selected control filter to the PXI processing unit.

### Applying to New Environments
- To use the CNN-based SFANC method in new acoustic environments, obtain the corresponding pre-trained control filters in the new acoustic paths. The trained CNN in the CNN-based SFANC method can remain unchanged. For more details, please refer to the paper.

## Related Works
- [Delayless Generative Fixed-filter Active Noise Control based on Deep Learning and Bayesian Filter](https://ieeexplore.ieee.org/document/10339836/)
- [Deep Generative Fixed-Filter Active Noise Control](https://arxiv.org/pdf/2303.05788)
- [GFANC-Kalman: Generative Fixed-Filter Active Noise Control with CNN-Kalman Filtering](https://ieeexplore.ieee.org/document/10323505)
- [Unsupervised-GFANC: Unsupervised Learning Based End-to-End Delayless Generative Fixed-Filter Active Noise Control](https://arxiv.org/pdf/2402.09460.pdf)
- [A hybrid sfanc-fxnlms algorithm for active noise control based on deep learning](https://arxiv.org/pdf/2208.08082)
- [Performance Evaluation of Selective Fixed-filter Active Noise Control based on Different Convolutional Neural Networks](https://arxiv.org/pdf/2208.08440)

**If you are interested in our works, please consider citing our papers. Thanks! Have a great day!**
